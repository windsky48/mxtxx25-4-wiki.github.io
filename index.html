<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>å¤–éƒ¨å›¾åºŠå¢™</title>
  <style>
    :root{--bg:#f5f7fa;--fg:#2c3e50;--accent:#3498db;--radius:6px}
    *{box-sizing:border-box}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;background:var(--bg);color:var(--fg);display:flex;height:100vh}
    nav{width:180px;background:#fff;border-right:1px solid #e5e5e5;padding:1.5rem 1rem;position:fixed;height:100%;left:0;top:0}nav a{display:block;margin:.6rem 0;color:var(--fg);text-decoration:none;font-weight:500;transition:color .2s}nav a:hover{color:var(--accent)}
    main{margin-left:180px;padding:2rem;width:100%;overflow-y:auto}section{margin-bottom:3rem}h2{margin-top:0}input[type=text]{width:100%;max-width:400px;padding:.5rem .75rem;border:1px solid #ccd1d9;border-radius:var(--radius);font-size:1rem}.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:1rem;margin-top:1rem}.grid img,.grid video{width:100%;height:120px;object-fit:cover;border-radius:var(--radius);background:#e5e5e5}.item{background:#fff;padding:.5rem;border-radius:var(--radius);box-shadow:0 1px 3px rgba(0,0,0,.08)}.hidden{display:none}
  </style>
</head>
<body>
  <nav>
    <a href="#img">ğŸ“· å›¾ç‰‡</a>
    <a href="#video">ğŸ¬ è§†é¢‘</a>
    <a href="#search">ğŸ” æœç´¢</a>
  </nav>
  <main>
    <section id="img"><h2>å›¾ç‰‡é¢„è§ˆ</h2><div id="imgGrid" class="grid"></div></section>
    <section id="video"><h2>è§†é¢‘é¢„è§ˆ</h2><div id="videoGrid" class="grid"></div></section>
    <section id="search">
      <h2>èµ„æºæœç´¢</h2>
      <input id="searchInput" type="text" placeholder="è¾“å…¥å…³é”®å­—è¿‡æ»¤">
    </section>
  </main>

  <script>
    /* ==========  å”¯ä¸€é…ç½®ï¼šå¡«å›¾åºŠå‚æ•°  ========== */
    const BUCKET = "mxc25-4";              // ä¾‹ï¼šmyimgbed
    const REGION = "oss-cn-shanghai";      // ä¾‹ï¼šoss-cn-shanghai
    const PREFIX = "";               // ç›®å½•å‰ç¼€ï¼ˆç©º = æ•´æ¡¶ï¼‰
    const LIST_API = `https://object-storage.mxc25-4.3d.tc/?list-type=2&prefix=${PREFIX}&max-keys=1000`;
    const RAW_BASE = `https://object-storage.mxc25-4.3d.tc/`;

    const imgExts = ["jpg", "jpeg", "png", "gif", "webp", "svg"];
    const videoExts = ["mp4", "webm", "ogg"];

    /* ==========  é€’å½’æ‰«æ XML  ========== */
    async function load() {
      const resp = await fetch(LIST_API);
      if (!resp.ok) { alert("åˆ—ä¸¾å¤±è´¥ï¼Œæ£€æŸ¥ CORS æˆ–è·¯å¾„"); return; }
      const text = await resp.text();
      const data = new DOMParser().parseFromString(text, "text/xml");
      const contents = Array.from(data.querySelectorAll("Key"));
      for (const node of contents) {
        const key = node.textContent;
        const ext = key.split(".").pop().toLowerCase();
        if (imgExts.includes(ext)) addMedia(key, "img");
        if (videoExts.includes(ext)) addMedia(key, "video");
      }
    }
    function addMedia(key, type) {
      const grid = document.getElementById(type + "Grid");
      const item = document.createElement("div");
      item.className = "item";
      const media = document.createElement(type === "img" ? "img" : "video");
      if (type === "video") media.controls = true;
      media.src = `${RAW_BASE}/${key}`;
      item.appendChild(media);
      grid.appendChild(item);
    }

    /* ==========  æœç´¢è¿‡æ»¤  ========== */
    document.getElementById("searchInput").addEventListener("input", e => {
      const kw = e.target.value.toLowerCase();
      document.querySelectorAll(".grid .item").forEach(it => {
        const src = it.querySelector("img,video").src.toLowerCase();
        it.classList.toggle("hidden", kw && !src.includes(kw));
      });
    });

    /* ==========  å¹³æ»‘æ»šåŠ¨  ========== */
    document.querySelectorAll('a[href^="#"]').forEach(a => a.addEventListener("click", e => {
      e.preventDefault();
      document.querySelector(a.getAttribute("href")).scrollIntoView({ behavior: "smooth" });
    }));

    /* ==========  å…¥å£  ========== */
    load();
  </script>
</body>
</html>
